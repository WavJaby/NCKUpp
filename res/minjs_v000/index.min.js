"use strict";import{a as t,br as U,button as r,checkbox as q,div as u,doomHelperDebug as P,footer as B,form as F,h1 as c,h2 as d,h3 as o,img as n,input as g,li as m,mountableStylesheet as M,nav as K,p as O,QueryRouter as R,RouterLazyLoad as s,ShowIf as l,Signal as i,span as p,svg as e,text as w,TextState as a,ul as f}from"./domHelper.min.js";import{metaSet as z,metaType as J}from"./../lib/metaTag.js";import{fetchApi as h,isLocalNetwork as $,isMobile as Q}from"./../lib/lib.js";import{UserGuideTool as Y}from"./../userGuide.js";import V from"./../popupWindow.js";window.askForLoginAlert=()=>window.messageAlert.addInfo("éœ€è¦ç™»å…¥ä¾†ä½¿ç”¨æ­¤é é¢","å³ä¸Šè§’ç™»å…¥æŒ‰éˆ•ç™»å…¥",3e3),window.loadingElement=e('<circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5" stroke-linecap="square"/>',"0 0 50 50","loaderCircle"),window.pageLoading=new i(!1);{console.log("index.js Init"),window.messageAlert=new function(){const i=u("messageBox");function a(){r(this)}function n(e,t,o,n,s){const l=u(e,{onclick:a},p(t,"title"),p(o,"description",n),u("closeButton"));void 0!==s&&(l.removeTimeout=setTimeout(()=>r(l),s)),0<i.childElementCount?i.insertBefore(l,i.firstElementChild):i.appendChild(l),l.style.marginTop=-l.offsetHeight+"px",setTimeout(()=>{l.classList.add("animation"),l.style.marginTop="0"},10)}function r(e){e.removeAnimationTimeout||(clearTimeout(e.removeTimeout),e.style.opacity="0",e.style.marginTop=-e.offsetHeight-10+"px",e.removeAnimationTimeout=setTimeout(()=>{i.removeChild(e)},500))}this.element=i,this.addInfo=function(e,t,o){n("info",e,t,null,o)},this.addError=function(e,t,o){n("error",e,t,null,o)},this.addErrorElement=function(e,t,o){n("error",e,null,t,o)},this.addSuccess=function(e,t,o){n("success",e,t,null,o)},this.addSuccessElement=function(e,t,o){n("success",e,null,t,o)}},window.requestState=new function(){const t=this.element=u("stateBox noSelect");this.addState=function(e){return t.appendChild(u(null,window.loadingElement.cloneNode(!0),c(e,"title")))},this.removeState=function(e){t.removeChild(e)}};const L=M("https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap");document.requestStorageAccess&&document.requestStorageAccess().then(()=>console.log("StorageAccess granted"),()=>console.log("StorageAccess denied"));var b=$||window.localStorage&&!!localStorage.getItem("debug");let e=null;if(b){function v(e){return e.toString().padStart(2,"0")}console.log("Debug enabled"),P();var S=new Date;if(console.log(`${S.getFullYear()}-${v(S.getMonth()+1)}-${v(S.getDate())}T${v(S.getHours())}:${v(S.getMinutes())}:`+v(S.getSeconds())+(0<(S=S.getTimezoneOffset())?"-"+v(S/60|0)+":"+v(S%60):"+"+v(-S/60|0)+":"+v(-S%60))),window.performance&&window.performance.memory){const N=new i(window.performance.memory);setInterval(()=>N.set(window.performance.memory),1e3),e=p(a(N,e=>(e.usedJSHeapSize/1e3/1e3).toFixed(2)+"MB"),null,{style:"position: absolute; top: 0; z-index: 100; background: black; font-size: 10px; opacity: 0.5;"})}}else console.log("Debug disable");const T=new V({small:!0,padding:!1});var S=new Y,y={Home:"æˆåŠŸå¤§å­¸èª²ç¨‹è³‡è¨ŠåŠé¸èª²ç³»çµ±",CourseSearch:"èª²ç¨‹æŸ¥è©¢",Schedule:"æˆ‘çš„èª²è¡¨",GradeInquiry:"æˆç¸¾æŸ¥è©¢",CourseSelectionPreference:"å¿—é¡˜æ’åº",UsefulWebsite:"å¯¦ç”¨ç¶²ç«™",Profile:"ä½¿ç”¨è€…è³‡æ–™"};const A=new i,_=new i(!1),D=new R("NCKU++",y,"Home",{Home:new s("./res/minjs_v000/home.min.js"),CourseSearch:new s("./res/pages/courseSearch.js",A,S),Schedule:new s("./res/pages/courseSchedule.js",A),GradeInquiry:new s("./res/pages/stuIdSysGrades.js",A),CourseSelectionPreference:new s("./res/pages/preferenceAdjust.js",A),UsefulWebsite:new s("./res/pages/usefulWebsite.js",A),Profile:new s("./res/pages/profile.js",A)},B(u("borderLine"),u("source",d("è³‡æ–™ä¾†æº"),t(null,"https://course.ncku.edu.tw/","noSelect",null,{target:"_blank"},n("res/assets/NCKU_course_system_logo.png","åœ‹ç«‹æˆåŠŸå¤§å­¸èª²ç¨‹è³‡è¨ŠåŠé¸èª²ç³»çµ±","noDrag")),t(null,"https://nckuhub.com/","noSelect",null,{target:"_blank"},n("res/assets/nckuHub_logo.svg","NCKUHub","noDrag")),t(null,"https://urschool.org/","noSelect",null,{target:"_blank"},n("res/assets/UrSchool_logo.png","UrSchool","noDrag")),u("splitLine")),o("By WavJaby"),o("Email: WavJaby@gmail.com"),t(null,"https://github.com/WavJaby/NCKUpp","openRepo noSelect",null,{target:"_blank"},n("./res/assets/github_icon.svg","GitHub icon","githubIcon noDrag"),p("GitHub repo")))),j=(S.setRouter(D),enableGoogleAnalytics(b),{});for(const G of["CourseSearch","Schedule","GradeInquiry","CourseSelectionPreference","UsefulWebsite"])j[G]=m(null,t(y[G],"./?page="+G,null,C,{pageId:G}));D.onPageOpen=function(e,t){"GradeInquiry"!==t&&"GradeInquiry"!==e&&A.state||h("/login?mode="+E(t),"Check login").then(I);var o=j[e],e=(e&&o&&o.classList.remove("opened"),j[t]);e&&e.classList.add("opened"),z(J.TITLE,document.title)};const H=u("navBarMobileBG",{onclick:k}),x=f("links",Object.values(j),m(null,function(e,t,o,n,s){const l=f(null),i=f(e?"list "+e:"list",n?{onmouseleave:u,onmouseenter:r}:null,m("items",l),m("title",t,{onclick:function(){s&&!s()&&!i.style.height||(i.style.height?u:r)()}}));for(const d of o){var a=d[1];l.appendChild(m(null,w(d[0]),{onItemClick:a,onclick:u}))}function r(){i.style.height=i.firstElementChild.offsetHeight+i.lastElementChild.offsetHeight+"px",window.addEventListener("pointerup",c)}function u(){this&&this.onItemClick&&this.onItemClick(),i.style.height=null,window.removeEventListener("pointerup",c)}function c(e){let t=e.target;do{if(t===i)return}while((t=t.parentElement)!==document.body);u()}return i}("arrow",w("0w0"),[["å—¨å—¨",null],["ğŸ¥°",null]]))),W=K("navbar noSelect",r("hamburgerMenu",null,function(){H.classList.toggle("open"),x.classList.toggle("open")},n("./res/assets/burger_menu_icon.svg","mobile menu button","noDrag noSelect")),t(null,"./?page=Home","homePage",C,{pageId:"Home"},n("./res/assets/page_home/logo_text.svg","NCKU"),n("./res/assets/page_home/logo_plusplus_text.svg","++")),H,x,r("loginBtn",null,()=>(k(),A.state&&A.state.login?(h("/logout").then(I),!0):(_.set(!_.state),!1)),n("./res/assets/login_icon.svg",""),p(a(A,e=>e&&e.login?e.studentID:"ç™»å…¥"))));function k(){H.classList.remove("open"),x.classList.remove("open")}window.navMenuClose=k,D.element.addEventListener("scroll",()=>{0===D.element.scrollTop?W.classList.remove("scroll"):W.classList.add("scroll")});const X=u("root",W,D.element,S.element,l(_,function(t,o){const n=g("loginField","å­¸è™Ÿ",null,{type:"text",autocomplete:"username"}),s=(n.value=localStorage.getItem("studentId")||"",g("loginField","å¯†ç¢¼",null,{type:"password",autocomplete:"current-password"})),l=q("loginDeclaration","true"===localStorage.getItem("loginDeclaration"),function(){localStorage.setItem("loginDeclaration",this.checked)},p("æˆ‘å·²é–±è®€"),r(null,"ç™»å…¥è²æ˜",function(){T.isEmpty()&&T.windowSet(u("loginDeclarationWindow",c("è²æ˜"),O(null,"declaration",p("æœ¬ç¶²ç«™ä¸æœƒå°‡å¯†ç¢¼ä»¥ä»»ä½•å½¢å¼æš«å­˜æˆ–å„²å­˜","red"),w("ï¼Œç™»å…¥åŠŸèƒ½åƒ…ä»£æ›¿ä½¿ç”¨è€…å°‡è³‡æ–™è½‰è‡³æˆåŠŸå…¥å£ï¼Œä¸¦å›å‚³ç™»å…¥ç‹€æ…‹(Session Cookie)ã€‚\n"),p("æœ¬ç¶²ç«™åƒ…å„²å­˜å­¸è™Ÿä»¥åŠç™»å…¥ç‹€æ…‹(Session Cookie)ï¼Œæä¾›é™„åŠ åŠŸèƒ½ä¹‹ç™»å…¥é©—è­‰ä½¿ç”¨","red"),w("ã€‚\n\næˆåŠŸå¤§å­¸ä¸¦æœªå…¬é–‹é©—è­‰ç³»çµ±çš„apiï¼Œå°‡ä¾†æœƒå˜—è©¦çˆ­å–æˆåŠŸå…¥å£é©—è­‰ç³»çµ±ä½œç‚ºæœ¬ç¶²ç«™ä¹‹ç™»å…¥æ–¹å¼ã€‚\nå¦‚æœé‚„æœƒæ“”å¿ƒè«‹åœ¨ä½¿ç”¨å®Œç•¢å¾Œç™»å‡ºï¼Œä¸”ä¸éœ€ç™»å…¥ä¹Ÿå¯ä»¥ä½¿ç”¨æŸ¥è©¢åŠŸèƒ½ã€‚\næœ¬ç¶²ç«™é–‹æºï¼Œå¦‚å°ä»¥ä¸Šè²æ˜æœ‰ç–‘æ…®ï¼Œè«‹è‡ªè¡Œå°‡å°ˆæ¡ˆä¸‹è¼‰å¾ŒåŸ·è¡Œã€‚"))));T.windowOpen()},{type:"button"}));let i=!1;const a=F("loginWindow",function(e){e.preventDefault(),i||(l.input.checked?(i=!0,window.pageLoading.set(!0),e=n.value.endsWith("@ncku.edu.tw")?n:n.value+"@ncku.edu.tw",h("/login?mode="+E(D.getCurrentPage()),"login",{method:"POST",body:JSON.stringify({username:e,password:s.value}),timeout:1e4}).then(e=>{i=!1,window.pageLoading.set(!1),e.success&&e.data.login&&localStorage.setItem("studentId",n.value),t(e)})):messageAlert.addError("è«‹å…ˆé–±è®€ç™»å…¥è²æ˜","",2e3))},{onRender:()=>{window.addEventListener("click",e),n.focus()},onDestroy:()=>window.removeEventListener("click",e)},d("ç™»å…¥"),n,s,p("å¸³å¯†èˆ‡æˆåŠŸå…¥å£ç›¸åŒ","description"),u("bottomRow",l,r("loginField","ç™»å…¥",null,{type:"submit"})));return a;function e(e){let t=e.target;for(;t.parentElement;){if(t===a||t===window.messageAlert.element||"loginBtn"===t.className||t.className.startsWith("popupWindow"))return;if(t===document.body)break;t=t.parentElement}o.set(!1)}}(I,_)),l(window.pageLoading,u("loading",window.loadingElement.cloneNode(!0))),window.messageAlert.element,window.requestState.element,e);function C(e){e.preventDefault();e=this.pageId;return D.openPage(e),k(),!1}function I(e){var t;e?(t=e.data)?!t.login&&e.msg?window.messageAlert.addError("Login failed",e.msg,5e3):(A.set(t),t.login&&_.set(!1)):window.messageAlert.addError("Unknown login error","Try again later",3e3):window.messageAlert.addError("Network error","Try again later",3e3)}function E(e){return"GradeInquiry"===e?"stuId":"course"}window.onload=()=>{for(console.log("Window onload"),L.mount();document.body.firstChild;)document.body.removeChild(document.body.firstChild);document.body.appendChild(X),D.initFirstPage(),Q()&&window.messageAlert.addInfo("å¯ä½¿ç”¨é›»è…¦ä¾†ç²å¾—æœ€ä½³é«”é©—","æ‰‹æ©Ÿç‰ˆå…·å®Œæ•´åŠŸèƒ½ï¼Œä½†ä»‹é¢æ­£åœ¨èª¿æ•´ä¸­ï¼Œè«‹è¦‹è«’",1e4),document.location.host.startsWith("wavjaby.github.io")&&window.messageAlert.addErrorElement("ä¸»è¦ä¼ºæœå™¨ç›®å‰ä¸ç©©å®š",u(null,p("ä¸»è¦ä¼ºæœå™¨ç›®å‰ä¸ç©©å®šï¼Œè«‹ä½¿ç”¨å‚™ç”¨ä¼ºæœå™¨ã€‚(æ­‰ğŸ¥¹"),U(),t(" é»æˆ‘é€²å…¥å‚™ç”¨ä¼ºæœå™¨","https://37a2-2001-b400-e285-37e9-b913-f26-1403-da61.ngrok-free.app/NCKUpp/")),1e5)}}
//# sourceMappingURL=index.min.js.map