"use strict";import{a as o,button as l,div as u,doomHelperDebug as n,footer as B,h1 as r,h2 as G,h3 as t,img as s,input as a,li as g,mountableStylesheet as F,nav as N,p as q,QueryRouter as M,RouterLazyLoad as i,ShowIf as c,Signal as d,span as m,svg as e,text as p,TextState as w,ul as f}from"./domHelper.min.js";import{metaSet as R,metaType as $}from"./../lib/metaTag.js";import{fetchApi as h,isLocalNetwork as z}from"./../lib/lib.js";import{UserGuideTool as J}from"./../userGuide.js";import K from"./../popupWindow.js";window.askForLoginAlert=()=>window.messageAlert.addInfo("éœ€è¦ç™»å…¥ä¾†ä½¿ç”¨æ­¤é é¢","å³ä¸Šè§’ç™»å…¥æŒ‰éˆ•ç™»å…¥",3e3),window.loadingElement=e('<circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5" stroke-linecap="square"/>',"0 0 50 50","loaderCircle"),window.pageLoading=new d(!1);{console.log("index.js Init"),window.messageAlert=new function(){const l=u("messageBox");function r(){a(this)}function t(e,o,n,t,s){const i=u(e,{onclick:r},m(o,"title"),m(n,"description",t),u("closeButton"));void 0!==s&&(i.removeTimeout=setTimeout(()=>a(i),s)),0<l.childElementCount?l.insertBefore(i,l.firstElementChild):l.appendChild(i),i.style.marginTop=-i.offsetHeight+"px",setTimeout(()=>{i.classList.add("animation"),i.style.marginTop="0"},10)}function a(e){e.removeAnimationTimeout||(clearTimeout(e.removeTimeout),e.style.opacity="0",e.style.marginTop=-e.offsetHeight-10+"px",e.removeAnimationTimeout=setTimeout(()=>{l.removeChild(e)},500))}this.element=l,this.addInfo=function(e,o,n){t("info",e,o,null,n)},this.addError=function(e,o,n){t("error",e,o,null,n)},this.addErrorElement=function(e,o,n){t("error",e,null,o,n)},this.addSuccess=function(e,o,n){t("success",e,o,null,n)},this.addSuccessElement=function(e,o,n){t("success",e,null,o,n)}},window.requestState=new function(){const o=this.element=u("stateBox noSelect");this.addState=function(e){return o.appendChild(u(null,window.loadingElement.cloneNode(!0),r(e,"title")))},this.removeState=function(e){o.removeChild(e)}};const E=F("https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap");document.requestStorageAccess&&document.requestStorageAccess().then(()=>console.log("StorageAccess granted"),()=>console.log("StorageAccess denied"));var b=z||window.localStorage&&!!localStorage.getItem("debug");let e=null;if(b){function S(e){return e.toString().padStart(2,"0")}console.log("Debug enabled"),n();var y=new Date;if(console.log(`${y.getFullYear()}-${S(y.getMonth()+1)}-${S(y.getDate())}T${S(y.getHours())}:${S(y.getMinutes())}:`+S(y.getSeconds())+(0<(y=y.getTimezoneOffset())?"-"+S(y/60|0)+":"+S(y%60):"+"+S(-y/60|0)+":"+S(-y%60))),window.performance&&window.performance.memory){const x=new d(window.performance.memory);setInterval(()=>x.set(window.performance.memory),1e3),e=m(w(x,e=>(e.usedJSHeapSize/1e3/1e3).toFixed(2)+"MB"),null,{style:"position: absolute; top: 0; z-index: 100; background: black; font-size: 10px; opacity: 0.5;"})}}else console.log("Debug disable");const I=new K;var y=new J,v={Home:"æˆåŠŸå¤§å­¸èª²ç¨‹è³‡è¨ŠåŠé¸èª²ç³»çµ±",CourseSearch:"èª²ç¨‹æŸ¥è©¢",Schedule:"èª²è¡¨",GradeInquiry:"æˆç¸¾æŸ¥è©¢",CourseSelectionPreference:"å¿—é¡˜æ’åº",UsefulWebsite:"å¯¦ç”¨ç¶²ç«™",Profile:"ä½¿ç”¨è€…è³‡æ–™"};const H=new d,j=new d(!1),A=new M("NCKU++",v,"Home",{Home:new i("./res/minjs_v000/home.min.js"),CourseSearch:new i("./res/pages/courseSearch.js",H,y),Schedule:new i("./res/pages/courseSchedule.js",H),GradeInquiry:new i("./res/pages/stuIdSysGrades.js",H),CourseSelectionPreference:new i("./res/pages/preferenceAdjust.js",H),UsefulWebsite:new i("./res/pages/usefulWebsite.js",H),Profile:new i("./res/pages/profile.js",H)},B(u("borderLine"),u("source",G("è³‡æ–™ä¾†æº"),o(null,"https://course.ncku.edu.tw/","noSelect",null,{target:"_blank"},s("res/assets/NCKU_course_system_logo.png","åœ‹ç«‹æˆåŠŸå¤§å­¸èª²ç¨‹è³‡è¨ŠåŠé¸èª²ç³»çµ±","noDrag")),o(null,"https://nckuhub.com/","noSelect",null,{target:"_blank"},s("res/assets/nckuHub_logo.svg","NCKUHub","noDrag")),o(null,"https://urschool.org/","noSelect",null,{target:"_blank"},s("res/assets/UrSchool_logo.png","UrSchool","noDrag")),u("splitLine")),t("By WavJaby"),t("Email: WavJaby@gmail.com"),o(null,"https://github.com/WavJaby/NCKUpp","openRepo noSelect",null,{target:"_blank"},s("./res/assets/github_icon.svg","GitHub icon","githubIcon noDrag"),m("GitHub repo")))),D=(y.setRouter(A),enableGoogleAnalytics(b),{});for(const W of["CourseSearch","Schedule","GradeInquiry","CourseSelectionPreference","UsefulWebsite"])D[W]=g(null,o(v[W],"./?page="+W,null,k,{pageId:W}));A.onPageOpen=function(e,o){var n=D[e],e=(e&&n&&n.classList.remove("opened"),D[o]);e&&e.classList.add("opened"),R($.TITLE,document.title)};const U=f("links",Object.values(D),g(null,T("arrow",p("0w0"),[["å—¨å—¨",null],["ğŸ¥°",null]]))),P=f("navBarMobileBG",{onclick:C});function C(){U.classList.remove("open"),P.classList.remove("open")}window.navMenuClose=C,h("/login?mode=course","Check login").then(L);const _=u("root",N("navbar noSelect",T("loginBtn",m(w(H,e=>e&&e.login?e.studentID:"ç™»å…¥")),[["Profile",()=>A.openPage("Profile")],["Logout",()=>h("/logout").then(L)]],!1,()=>(C(),H.state&&H.state.login?!0:(j.set(!j.state),!1))),f("hamburgerMenu",g(null,s("./res/assets/burger_menu_icon.svg","mobile menu button","noDrag noSelect",{onclick:function(){U.classList.toggle("open"),P.classList.toggle("open")}}))),f("homePage",g(null,o("NCKU++","./?page=Home",null,k,{pageId:"Home"}))),P,U),A.element,y.element,c(j,function(o){const n=a("loginField","å­¸è™Ÿ",null,{onkeyup:e,type:"email",autocomplete:"username"}),t=a("loginField","å¯†ç¢¼",null,{onkeyup:e,type:"password",autocomplete:"current-password"});let s=!1;function e(e){"Enter"===e.key&&i()}function i(){var e;s||(s=!0,window.pageLoading.set(!0),e=n.value.endsWith("@ncku.edu.tw")?n:n.value+"@ncku.edu.tw",h("/login?mode=course","login",{method:"POST",body:`username=${encodeURIComponent(e)}&password=`+encodeURIComponent(t.value),timeout:1e4}).then(e=>{s=!1,window.pageLoading.set(!1),o(e)}))}return u("loginWindow",{onRender:()=>n.focus()},l("loginFunctionDeclaration","ç™»å…¥åŠŸèƒ½è²æ˜",function(){I.isEmpty()&&I.windowSet(u("loginFunctionDeclarationWindow",r("è²æ˜: "),q(null,"declaration",m("æœ¬ç¶²ç«™ä¸æœƒå°‡å¯†ç¢¼ä»¥ä»»ä½•å½¢å¼æš«å­˜æˆ–å„²å­˜","red"),p("ï¼Œç™»å…¥åŠŸèƒ½åƒ…ä»£æ›¿ä½¿ç”¨è€…å°‡è³‡æ–™è½‰è‡³æˆåŠŸå…¥å£ï¼Œä¸¦å›å‚³ç™»å…¥ç‹€æ…‹(Session Cookie)\n"),m("æœ¬ç¶²ç«™åƒ…å„²å­˜å­¸è™Ÿä»¥åŠç™»å…¥ç‹€æ…‹(Session Cookie)ï¼Œæä¾›é™„åŠ åŠŸèƒ½ä¹‹ç™»å…¥é©—è­‰ä½¿ç”¨\n","red"),p("é€™æ˜¯ä¸å¾—å·²çš„ï¼Œæˆå¤§ä¸åƒå…¶ä»–å­¸æ ¡ï¼Œæˆå¤§ä¸¦æœªå…¬é–‹authé©—è­‰ç³»çµ±çš„apiï¼Œå¦‚æœæœƒæ“”å¿ƒçš„ä½¿ç”¨è€…å¯åœ¨ä½¿ç”¨å®Œç•¢å¾Œç™»å‡ºï¼Œä¸”ä¸ç™»å…¥ä¹Ÿå¯ä»¥ä½¿ç”¨æŸ¥è©¢åŠŸèƒ½\nå°‡ä¾†æœƒå˜—è©¦çˆ­å–æˆåŠŸå…¥å£é©—è­‰ç³»çµ±ä¹‹apiï¼Œä½œç‚ºæœ¬ç¶²ç«™ä¹‹ç™»å…¥æ–¹å¼\næœ¬ç¶²ç«™é–‹æºï¼Œå¦‚å°ä»¥ä¸Šè²æ˜é‚„æ˜¯æœ‰ç–‘æ…®ï¼Œè«‹è‡ªè¡Œå°‡å°ˆæ¡ˆä¸‹è¼‰å¾ŒåŸ·è¡Œ")))),I.windowOpen()}),n,t,m("å¸³å¯†èˆ‡æˆåŠŸå…¥å£ç›¸åŒ","description"),l("loginField","ç™»å…¥",i,{type:"submit"}))}(L)),c(window.pageLoading,u("loading",window.loadingElement.cloneNode(!0))),window.messageAlert.element,window.requestState.element,e);function k(e){e.preventDefault();e=this.pageId;return A.openPage(e),C(),!1}function L(e){var o;e?(o=e.data)?!o.login&&e.msg?window.messageAlert.addError("Login failed",e.msg,5e3):(H.set(o),j.set(!1)):window.messageAlert.addError("Unknown login error","Try again later",3e3):window.messageAlert.addError("Network error","Try again later",3e3)}function T(e,o,n,t,s){var i=f(null);const l=f(e?"list "+e:"list",t?{onmouseleave:u,onmouseenter:a}:null,g("items",i),g("title",o,{onclick:function(){s&&!s()&&!l.style.height||(l.style.height?u:a)()}}));for(const d of n){var r=d[1];i.appendChild(g(null,p(d[0]),{onItemClick:r,onclick:u}))}function a(){l.style.height=l.firstElementChild.offsetHeight+l.lastElementChild.offsetHeight+"px",window.addEventListener("pointerup",c)}function u(){this&&this.onItemClick&&this.onItemClick(),l.style.height=null,window.removeEventListener("pointerup",c)}function c(e){let o=e.target;do{if(o===l)return}while((o=o.parentElement)!==document.body);u()}return l}window.onload=()=>{for(console.log("Window onload"),E.mount();document.body.firstChild;)document.body.removeChild(document.body.firstChild);document.body.appendChild(_),A.initFirstPage()}}
//# sourceMappingURL=index.min.js.map